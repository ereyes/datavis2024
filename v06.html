<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Extractor</title>
    <script src="https://cdn.jsdelivr.net/npm/colorthief@2.3.0/dist/color-thief.umd.js"></script>
    <style>
        #dropZone {
            border: 2px dashed #ccc;
            padding: 20px;
            text-align: center;
            cursor: pointer;
        }

        #result {
            margin-top: 20px;
        }

        #result div {
            width: 50px;
            height: 50px;
        }
    </style>
</head>
<body>
    <h1>Image Dominant Color Extractor</h1>
    
    <div id="dropZone" ondrop="handleDrop(event)" ondragover="handleDragOver(event)">
        <p>Drag and drop a CSV file here, or click to select one.</p>
    </div>

    <div id="result"></div>

    <script>
        function handleDrop(event) {
            event.preventDefault();
            var files = event.dataTransfer.files;

            if (files.length > 0) {
                var file = files[0];

                if (file.type === 'text/csv') {
                    parseCSV(file);
                } else {
                    alert('Please drop a CSV file.');
                }
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
        }

        function parseCSV(file) {
            var reader = new FileReader();

            reader.onload = function (e) {
                var csvContent = e.target.result;
                var urls = csvContent.split('\n').map(function (line) {
                    return line.trim();
                }).filter(function (line) {
                    return line !== '';
                });

                extractColorsFromUrls(urls);
            };

            reader.readAsText(file);
        }

        function extractColorsFromUrls(urls) {
            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '';

            urls.forEach(function (url) {
                var img = new Image();
                img.crossOrigin = 'Anonymous';
                img.src = url;

                img.onload = function () {
                    var colorThief = new ColorThief();
                    var dominantColor = colorThief.getColor(img);

                    displayResult(resultDiv, dominantColor);
                };
            });
        }

        function displayResult(resultDiv, rgb) {
            var colorSquare = document.createElement('div');
            colorSquare.style.backgroundColor = 'rgb(' + rgb.join(',') + ')';
            resultDiv.appendChild(colorSquare);

            var p = document.createElement('p');
            p.textContent = 'RGB Values: ' + rgb.join(', ');
            resultDiv.appendChild(p);
        }
    </script>
</body>
</html>
